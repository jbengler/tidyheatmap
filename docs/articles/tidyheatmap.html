<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • tidyheatmap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyheatmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tidyheatmap.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jbengler/tidyheatmap">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbengler/tidyheatmap/blob/master/vignettes/tidyheatmap.Rmd"><code>vignettes/tidyheatmap.Rmd</code></a></small>
      <div class="hidden name"><code>tidyheatmap.Rmd</code></div>

    </div>

    
    
<p><code>tidyheatmap</code> provides a tidyverse-style interface to the powerful heatmap package <a href="https://github.com/raivokolde/pheatmap">pheatmap</a> by <a href="https://github.com/raivokolde">@raivokolde</a>. Although heatmaps can be generated via <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">ggplot2::geom_tile()</a></code>, it is hard to reach the versatility and beauty of a genuine heatmap function like <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap::pheatmap()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyheatmap)</a></code></pre></div>
<div id="data-requirements" class="section level2">
<h2 class="hasAnchor">
<a href="#data-requirements" class="anchor"></a>Data requirements</h2>
<p><code><a href="../reference/tidy_heatmap.html">tidy_heatmap()</a></code> requires tidy data in long format, see <a href="https://tidyr.tidyverse.org/index.html">tidyverse</a>.</p>
<p>As an example we will use the gene expression data set <code>data_exprs</code>. In the tidyverse lingo the columns of a data frame are called <em>variables</em>. One of these variables named <code>expression</code> contains the numeric values to be color-coded in the heatmap. Furthermore we will use the variables <code>sample</code> for heatmap columns and <code>external_gene_name</code> for heatmap rows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">data_exprs</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; # A tibble: 800 x 12</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;    ensembl_gene_id external_gene_n… Eip_vs_Hip.padj direction is_immune_gene</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;         </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;  1 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  2 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  3 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  4 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  5 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  6 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  7 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  8 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;  9 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; 10 ENSMUSG0000003… Apol6                   3.79e-28 up        no            </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; # … with 790 more rows, and 7 more variables: count_type &lt;chr&gt;, group &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; #   replicate &lt;chr&gt;, expression &lt;dbl&gt;, sample &lt;chr&gt;, sample_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; #   condition &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">data_exprs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(external_gene_name <span class="op">==</span><span class="st"> "Bsn"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(external_gene_name, sample, expression)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; # A tibble: 20 x 3</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;    external_gene_name sample expression</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt;  1 Bsn                Hin_1        9.59</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt;  2 Bsn                Hin_2        9.48</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt;  3 Bsn                Hin_3        9.66</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt;  4 Bsn                Hin_4        9.62</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt;  5 Bsn                Hin_5        9.25</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt;  6 Bsn                Ein_1        9.55</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt;  7 Bsn                Ein_2       10.3 </span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt;  8 Bsn                Ein_3        9.98</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt;  9 Bsn                Ein_4        9.82</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; 10 Bsn                Ein_5        9.47</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt; 11 Bsn                Hip_1        9.43</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt; 12 Bsn                Hip_2        9.40</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co">#&gt; 13 Bsn                Hip_3        9.52</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#&gt; 14 Bsn                Hip_4        9.26</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co">#&gt; 15 Bsn                Hip_5       10.2 </span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co">#&gt; 16 Bsn                Eip_1       11.9 </span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co">#&gt; 17 Bsn                Eip_2       11.4 </span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">#&gt; 18 Bsn                Eip_3       11.1 </span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt; 19 Bsn                Eip_4       11.6 </span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co">#&gt; 20 Bsn                Eip_5       11.5</span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43"></a>
<a class="sourceLine" id="cb2-44" data-line-number="44"><span class="kw">glimpse</span>(data_exprs)</a>
<a class="sourceLine" id="cb2-45" data-line-number="45"><span class="co">#&gt; Observations: 800</span></a>
<a class="sourceLine" id="cb2-46" data-line-number="46"><span class="co">#&gt; Variables: 12</span></a>
<a class="sourceLine" id="cb2-47" data-line-number="47"><span class="co">#&gt; $ ensembl_gene_id    &lt;chr&gt; "ENSMUSG00000033576", "ENSMUSG00000033576", "ENSMU…</span></a>
<a class="sourceLine" id="cb2-48" data-line-number="48"><span class="co">#&gt; $ external_gene_name &lt;chr&gt; "Apol6", "Apol6", "Apol6", "Apol6", "Apol6", "Apol…</span></a>
<a class="sourceLine" id="cb2-49" data-line-number="49"><span class="co">#&gt; $ Eip_vs_Hip.padj    &lt;dbl&gt; 3.793735e-28, 3.793735e-28, 3.793735e-28, 3.793735…</span></a>
<a class="sourceLine" id="cb2-50" data-line-number="50"><span class="co">#&gt; $ direction          &lt;chr&gt; "up", "up", "up", "up", "up", "up", "up", "up", "u…</span></a>
<a class="sourceLine" id="cb2-51" data-line-number="51"><span class="co">#&gt; $ is_immune_gene     &lt;chr&gt; "no", "no", "no", "no", "no", "no", "no", "no", "n…</span></a>
<a class="sourceLine" id="cb2-52" data-line-number="52"><span class="co">#&gt; $ count_type         &lt;chr&gt; "vsd", "vsd", "vsd", "vsd", "vsd", "vsd", "vsd", "…</span></a>
<a class="sourceLine" id="cb2-53" data-line-number="53"><span class="co">#&gt; $ group              &lt;chr&gt; "Hin", "Hin", "Hin", "Hin", "Hin", "Ein", "Ein", "…</span></a>
<a class="sourceLine" id="cb2-54" data-line-number="54"><span class="co">#&gt; $ replicate          &lt;chr&gt; "1", "2", "3", "4", "5", "1", "2", "3", "4", "5", …</span></a>
<a class="sourceLine" id="cb2-55" data-line-number="55"><span class="co">#&gt; $ expression         &lt;dbl&gt; 2.203755, 2.203755, 2.660558, 2.649534, 3.442740, …</span></a>
<a class="sourceLine" id="cb2-56" data-line-number="56"><span class="co">#&gt; $ sample             &lt;chr&gt; "Hin_1", "Hin_2", "Hin_3", "Hin_4", "Hin_5", "Ein_…</span></a>
<a class="sourceLine" id="cb2-57" data-line-number="57"><span class="co">#&gt; $ sample_type        &lt;chr&gt; "input", "input", "input", "input", "input", "inpu…</span></a>
<a class="sourceLine" id="cb2-58" data-line-number="58"><span class="co">#&gt; $ condition          &lt;chr&gt; "healthy", "healthy", "healthy", "healthy", "healt…</span></a></code></pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>The basic layout of the heatmap relies on the parameters <code>rows</code>, <code>columns</code> and <code>values</code>. You can think of them like aesthetics in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code>, similar to something like <code>aes(x = columns, y = rows, fill = values)</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">             <span class="dt">values =</span> expression</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="features" class="section level2">
<h2 class="hasAnchor">
<a href="#features" class="anchor"></a>Features</h2>
<div id="data-scaling" class="section level3">
<h3 class="hasAnchor">
<a href="#data-scaling" class="anchor"></a>Data scaling</h3>
<p>With the parameter <code>scale</code> you can activate data scaling for <code>"row"</code> or <code>"column"</code>. By default data scaling is turned off <code>scale = "none"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">             <span class="dt">scale =</span> <span class="st">"row"</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="ordering" class="section level3">
<h3 class="hasAnchor">
<a href="#ordering" class="anchor"></a>Ordering</h3>
<p>Rows and columns in the heatmap will appear in the same order as in the tidy data frame used as input. For example, to order rows and columns alphabetically, just use the <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">data_exprs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(external_gene_name, sample) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(<span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">               <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">               <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">               <span class="dt">scale =</span> <span class="st">"row"</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  )</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="color-legend" class="section level3">
<h3 class="hasAnchor">
<a href="#color-legend" class="anchor"></a>Color legend</h3>
<p>You can customize the number of colors <code>color_scale_n</code> and also the minimum and maximum values of the color legend, <code>color_scale_min</code> and <code>color_scale_max</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">             <span class="dt">color_scale_n =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">             <span class="dt">color_scale_min =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">             <span class="dt">color_scale_max =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Of course, you can also replace the color legend altogether.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">             <span class="dt">colors =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#161523"</span>,<span class="st">"#1C1E4C"</span>,<span class="st">"#2D3679"</span>,<span class="st">"#3B4D98"</span>,<span class="st">"#49569F"</span>,<span class="st">"#69549D"</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                       <span class="st">"#855097"</span>,<span class="st">"#9E4F96"</span>,<span class="st">"#CA5296"</span>,<span class="st">"#DC5F8E"</span>,<span class="st">"#E17872"</span>,<span class="st">"#E58D63"</span>,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                       <span class="st">"#EDA962"</span>,<span class="st">"#F5CA66"</span>,<span class="st">"#F9E96C"</span>,<span class="st">"#EEE969"</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; Warning in if (is.na(colors)) colors &lt;- rev(RColorBrewer::brewer.pal(n = 7, :</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; Bedingung hat Länge &gt; 1 und nur das erste Element wird benutzt</span></a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="annotations" class="section level3">
<h3 class="hasAnchor">
<a href="#annotations" class="anchor"></a>Annotations</h3>
<p>Annotations can be added for both <code>rows</code> and <code>columns</code> via <code>ann_row</code> and <code>ann_col</code>, respectively. Just specify the corresponding variables in the tidy data frame. If you want more then one variable for annotation just combine them by <code><a href="https://rdrr.io/r/base/c.html">c(var1, var2, var3)</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">             <span class="dt">annotation_col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(sample_type, condition, group),</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">             <span class="dt">annotation_row =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(is_immune_gene, direction),</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">             <span class="dt">color_scale_n =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">             <span class="dt">color_scale_min =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">             <span class="dt">color_scale_max =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="customize-annotations-colors" class="section level3">
<h3 class="hasAnchor">
<a href="#customize-annotations-colors" class="anchor"></a>Customize annotations colors</h3>
<p>You can provide a list of named vectors to take control over the annotations colors <code>ann_colors</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">ann_colors &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">condition =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">EAE =</span> <span class="st">"#BD79B4"</span>, <span class="dt">healthy =</span> <span class="st">"#F5CEF2"</span>),</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">group =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">Ein =</span> <span class="st">"#C14236"</span>, <span class="dt">Eip =</span> <span class="st">"#E28946"</span>, <span class="dt">Hin =</span> <span class="st">"#4978AB"</span>, <span class="dt">Hip =</span> <span class="st">"#98BB85"</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">sample_type =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">input =</span> <span class="st">"#BDBDBD"</span>, <span class="dt">IP =</span> <span class="st">"#7D7D7D"</span>),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="dt">direction =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">down =</span> <span class="st">"#5071DC"</span>, <span class="dt">up =</span> <span class="st">"#C34B6B"</span>),</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  <span class="dt">is_immune_gene =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">yes =</span> <span class="st">"#B69340"</span>, <span class="dt">no =</span> <span class="st">"#FFFFFF"</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">             <span class="dt">annotation_col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(sample_type, condition, group),</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">             <span class="dt">annotation_row =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(is_immune_gene, direction),</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">             <span class="dt">color_scale_n =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">             <span class="dt">color_scale_min =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">             <span class="dt">color_scale_max =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">             <span class="dt">annotation_colors =</span> ann_colors</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="gaps" class="section level3">
<h3 class="hasAnchor">
<a href="#gaps" class="anchor"></a>Gaps</h3>
<p>Gaps can be added by specifying data frame variables that should be used to generate the gaps. Only one variable can be chosen for <code>gaps_row</code> and one for <code>gaps_col</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">             <span class="dt">annotation_col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(sample_type, condition, group),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">             <span class="dt">annotation_row =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(is_immune_gene, direction),</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">             <span class="dt">color_scale_n =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">             <span class="dt">color_scale_min =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">             <span class="dt">color_scale_max =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">             <span class="dt">annotation_colors =</span> ann_colors,</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">             <span class="dt">gaps_row =</span> direction,</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">             <span class="dt">gaps_col =</span> group</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="fix-cell-dimensions" class="section level3">
<h3 class="hasAnchor">
<a href="#fix-cell-dimensions" class="anchor"></a>Fix cell dimensions</h3>
<p>You can fix the cell dimensions via the <code>cellwidth</code> and <code>cellheight</code> parameters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">             <span class="dt">annotation_col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(sample_type, condition, group),</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">             <span class="dt">annotation_row =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(is_immune_gene, direction),</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">             <span class="dt">color_scale_n =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">             <span class="dt">color_scale_min =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">             <span class="dt">color_scale_max =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">             <span class="dt">annotation_colors =</span> ann_colors,</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">             <span class="dt">gaps_row =</span> direction,</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">             <span class="dt">gaps_col =</span> condition,</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">             <span class="dt">cellwidth =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">             <span class="dt">cellheight =</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="write-to-file" class="section level3">
<h3 class="hasAnchor">
<a href="#write-to-file" class="anchor"></a>Write to file</h3>
<p>You can use the parameter <code>filename</code> to write the heatmap to file.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">             <span class="dt">filename =</span> <span class="st">"my_heatmap.pdf"</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">)</a></code></pre></div>
</div>
</div>
<div id="more-features" class="section level2">
<h2 class="hasAnchor">
<a href="#more-features" class="anchor"></a>More features</h2>
<p>There are even more features like clustering and dendrograms implemented in <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap::pheatmap()</a></code>. All parameters that are not directly evaluated by <code><a href="../reference/tidy_heatmap.html">tidy_heatmap()</a></code> will be automatically passed to <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap::pheatmap()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/tidy_heatmap.html">tidy_heatmap</a></span>(data_exprs,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">             <span class="dt">rows =</span> external_gene_name,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">             <span class="dt">columns =</span> sample,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">             <span class="dt">values =</span> expression,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">             <span class="dt">annotation_col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(sample_type, condition, group),</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">             <span class="dt">annotation_row =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(is_immune_gene, direction),</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">             <span class="dt">scale =</span> <span class="st">"row"</span>,</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">             <span class="dt">color_scale_n =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">             <span class="dt">color_scale_min =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">             <span class="dt">color_scale_max =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">             <span class="dt">annotation_colors =</span> ann_colors,</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">             <span class="dt">cellwidth =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">             <span class="dt">cellheight =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">             <span class="dt">cluster_rows =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">             <span class="dt">cluster_cols =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16">)</a></code></pre></div>
<p><img src="tidyheatmap_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div id="whats-under-the-hood" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-under-the-hood" class="anchor"></a>What’s under the hood?</h2>
<p><code><a href="../reference/tidy_heatmap.html">tidy_heatmap()</a></code> takes the tidy data frame and the additional arguments and does the data wrangling needed to satisfy <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap::pheatmap()</a></code>. By setting <code>return_data = TRUE</code> you can get a glimpse at the result of the data wrangling.</p>
</div>
<div id="credit" class="section level2">
<h2 class="hasAnchor">
<a href="#credit" class="anchor"></a>Credit</h2>
<p>All the credit for the heatmap functionality goes to <a href="https://github.com/raivokolde">@raivokolde</a>, the creator of the brilliant <a href="https://github.com/raivokolde/pheatmap">pheatmap</a> package. <code>tidyheatmap</code> just provides a convenient interface to use <a href="https://github.com/raivokolde/pheatmap">pheatmap</a> in the <code>tidyverse</code> ecosystem.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-requirements">Data requirements</a></li>
      <li><a href="#basic-usage">Basic usage</a></li>
      <li><a href="#features">Features</a></li>
      <li><a href="#more-features">More features</a></li>
      <li><a href="#whats-under-the-hood">What’s under the hood?</a></li>
      <li><a href="#credit">Credit</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jan Broder Engler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
